(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,,,function(t,e,n){},,,function(t,e,n){t.exports=n.p+"static/media/search.97161617.svg"},function(t,e,n){t.exports=n.p+"static/media/roulette.dc8d006c.svg"},function(t,e,n){t.exports=n.p+"static/media/spin.8f3bc11a.svg"},,,,function(t,e,n){t.exports=n(26)},,,,,function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){"use strict";n.r(e);var c,a=n(0),o=n.n(a),r=n(8),s=n.n(r),i=(n(21),n(1)),u=n(2),l=n(4),f=n(9),m=n.n(f),h=function(){function t(){Object(u.a)(this,t),this.client=void 0,this.auth=!1,this.client=new m.a}return Object(l.a)(t,[{key:"authenticateUser",value:function(){var t=window.location.hash.substring(1).split("&")[0].split("=")[1];window.location.hash="";t?(this.client.setAccessToken(t),this.auth=!0):window.location.href="".concat("https://accounts.spotify.com/authorize","?client_id=").concat("41e10dc3f3594667b190b3681fdee8ca","&redirect_uri=").concat("https://spotifyroulette.paulocorreia.me","&scope=").concat(["user-top-read","user-modify-playback-state"].join("%20"),"&response_type=token&show_dialog=true")}},{key:"searchTrack",value:function(t){return this.client.searchTracks(t)}},{key:"play",value:function(t){return this.client.play(t)}},{key:"isAuthenticated",value:function(){return this.auth}}]),t}(),b=(n(22),n(23),n(10)),d=n.n(b),p=(n(24),function(t){return o.a.createElement("div",{className:"result",onClick:t.onClick},o.a.createElement("img",{className:"cover",src:t.src,alt:"".concat(t.title," Album Cover")}),o.a.createElement("div",{className:"info"},o.a.createElement("h2",{className:"title"},t.title),o.a.createElement("p",{className:"artist"},t.author)))}),v=function(t){var e=Object(a.useRef)(null),n=Object(a.useState)(""),c=Object(i.a)(n,2),r=c[0],s=c[1],u=Object(a.useState)(""),l=Object(i.a)(u,2),f=l[0],m=l[1];Object(a.useEffect)(function(){e.current&&(e.current.addEventListener("focus",function(){return h(!0)}),e.current.addEventListener("focusout",function(){return h(!1)}))});var h=function(t){t&&0===f.length?s("focused"):t||f.length>0?s("focused"):s("")},b=t.results.map(function(e,n){return o.a.createElement(p,Object.assign({key:n},e,{onClick:function(){return t.onResultClick(n)}}))});return o.a.createElement("div",{className:"input ".concat(r),style:{height:"".concat(88+64*t.results.length+(t.results.length?8:0),"px")}},o.a.createElement("div",{className:"searchBar"},o.a.createElement("input",{type:"text",ref:e,value:f,onChange:function(t){m(t.target.value)},placeholder:"Search"}),o.a.createElement("button",{onClick:function(){null!==f&&""!==f&&t.onSearch(f)}},o.a.createElement("img",{src:d.a,alt:""}))),!!t.results.length&&o.a.createElement("div",{className:"results"},b))},O=n(3),E=(n(7),n(11)),j=n.n(E),y=function(t){return function(t){var e=Object(a.useRef)(new O.Howl({src:"/audio/load.mp3"}));Object(a.useEffect)(function(){t&&e.current.play()},[t])}(t.loading),function(t,e){var n=Object(a.useRef)(new O.Howl({src:5===e?"/audio/shot.mp3":"/audio/blank.mp3"}));Object(a.useEffect)(function(){t&&n.current.play()},[t])}(t.shot,t.position),o.a.createElement("div",{className:"container",style:{transform:"rotate(".concat(-60*t.position,"deg)")}},o.a.createElement("div",{className:"cover ".concat(t.load&&"load")},o.a.createElement("img",{className:t.shot?"shot":"",src:t.src,alt:""})))};!function(t){t.EMPTY="empty",t.HALF="half",t.FULL="full"}(c||(c={}));var S,g=function(t){var e=Object(a.useState)(-1),n=Object(i.a)(e,2),r=n[0],s=n[1],u=Object(a.useState)(0),l=Object(i.a)(u,2),f=l[0],m=l[1],h=Object(a.useState)(c.EMPTY),b=Object(i.a)(h,2),d=b[0],p=b[1],v=function(t){var e=Object(a.useState)(-1),n=Object(i.a)(e,2),c=n[0],o=n[1];Object(a.useEffect)(function(){setTimeout(function(){t?(c>=0&&c<4&&r(),5===c&&r()):c>=0&&c<6&&r()},1500)},[c,t]);var r=function(){return o(function(t){return t+1})};return[c,r,function(){return o(-1)}]}(t.chooseBullet),E=Object(i.a)(v,3),g=E[0],k=E[1],w=E[2];!function(t){var e=Object(a.useRef)(new O.Howl({src:"/audio/spin.mp3"}));Object(a.useEffect)(function(){t&&e.current.play()},[t])}(t.state===S.SPINING);var N=[t.blank,t.blank,t.blank,t.blank,t.blank,t.bullet].map(function(e,n){return o.a.createElement(y,{key:n,src:e,position:n,shot:n===r&&t.state===S.SHOT,load:n<=g,loading:n===g&&t.state===S.LOADING})}),L=function(e,n){k(),setTimeout(function(){e()},n),t.setState(S.LOADING)},I=function(){s(-1),m(0),w(),p(c.EMPTY)},T=function(t){document.documentElement.style.setProperty("--previous","".concat(t))};Object(a.useEffect)(function(){if(t.state===S.LOAD)t.chooseBullet?d===c.EMPTY?L(function(){p(c.HALF),m(5),t.setState(S.IDLE)},7500):d===c.HALF?L(function(){t.setState(S.SPIN),p(c.FULL),T(5)},500):I():(I(),L(function(){m(5),t.setState(S.SPIN),p(c.FULL),T(5)},8300));else if(t.state===S.SPIN&&d===c.FULL){var e=A();setTimeout(function(){m(e),T(e),t.setState(S.SHOT),t.onShoot(5===e)},1700),t.setState(S.SPINING)}});var A=function(){var t=Math.floor(6*Math.random());return document.documentElement.style.setProperty("--next","".concat(t)),s(t),t};return o.a.createElement("div",{className:"roulette ".concat(t.state," ").concat(d),style:{transform:"rotate(calc(60deg * ".concat(f,"))")}},N,o.a.createElement("img",{src:j.a,alt:""}))},k=(n(25),function(t){return o.a.createElement("button",{className:"actionButton ".concat(t.visible?"visible":"")},o.a.createElement("img",{src:t.src,alt:""}))}),w=n(12),N=n.n(w),L=n(14),I=n(13),T=n(15),A=function(t){function e(){return Object(u.a)(this,e),Object(L.a)(this,Object(I.a)(e).apply(this,arguments))}return Object(T.a)(e,t),Object(l.a)(e,[{key:"search",value:function(t){var e=this;this.spotify.searchTrack(t).then(function(t){e.setResults(t.tracks.items.slice(0,3))})}},{key:"formatResults",value:function(t){return t.map(function(t){return{title:t.name,author:t.artists[0].name,src:t.album.images[0].url}})}},{key:"getItemSrc",value:function(t){return void 0===t?"":t.album.images[0].url}},{key:"play",value:function(t){this.spotify.play({uris:[t.uri]})}}]),e}(function t(e,n){Object(u.a)(this,t),this.spotify=e,this.setResults=n});!function(t){t.IDLE="idle",t.LOAD="load",t.LOADING="loading",t.SPIN="spin",t.SPINING="spining",t.SHOT="shot"}(S||(S={}));var P=function(){var t=Object(a.useRef)(new h),e=Object(a.useState)(S.IDLE),n=Object(i.a)(e,2),c=n[0],r=n[1],s=Object(a.useState)([]),u=Object(i.a)(s,2),l=u[0],f=u[1],m=Object(a.useState)(),b=Object(i.a)(m,2),d=b[0],p=b[1],O=Object(a.useState)(),E=Object(i.a)(O,2),j=E[0],y=E[1],w=Object(a.useRef)(new A(t.current,f));Object(a.useEffect)(function(){t.current.isAuthenticated()||t.current.authenticateUser()},[]);return o.a.createElement("div",{className:"app"},o.a.createElement("div",{className:"controls"},o.a.createElement(v,{results:w.current.formatResults(l),onSearch:function(t){return w.current.search(t)},onResultClick:function(t){void 0===j?(y(l[t]),f([])):(p(l[t]),f([]),r(S.LOAD))}}),o.a.createElement(k,{src:N.a,visible:c===S.SHOT})),o.a.createElement(g,{blank:w.current.getItemSrc(j),bullet:w.current.getItemSrc(d),state:c,setState:r,chooseBullet:!1,onShoot:function(t){w.current.play(t?d:j)}}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(o.a.createElement(P,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}],[[16,1,2]]]);
//# sourceMappingURL=main.2b8bb112.chunk.js.map