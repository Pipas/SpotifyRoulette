(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,,,function(e,t,n){e.exports=n.p+"static/media/close.e85191c6.svg"},,,function(e,t,n){},,,function(e,t,n){e.exports=n.p+"static/media/search.97161617.svg"},function(e,t,n){e.exports=n.p+"static/media/roulette.dc8d006c.svg"},function(e,t,n){e.exports=n.p+"static/media/spin.8f3bc11a.svg"},function(e,t,n){e.exports=n.p+"static/media/settings.7c9f5af4.svg"},function(e,t,n){e.exports=n.p+"static/media/warning.34c3adc3.svg"},,function(e,t,n){e.exports=n(33)},,,,,function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a,c=n(0),r=n.n(c),s=n(11),i=n.n(s),o=(n(24),n(1)),u=n(18),l=n(2),f=n.n(l),m=n(3),h=n(4),d=n(5),p=n(12),b=n.n(p),v=function(){function e(t){Object(h.a)(this,e),this.client=void 0,this.auth=!1,this.deviceId="",this.controller=void 0,this.client=new b.a,this.controller=t}return Object(d.a)(e,[{key:"setController",value:function(e){this.controller=e}},{key:"authenticateUser",value:function(){var e=window.location.hash.substring(1).split("&")[0].split("=")[1];window.location.hash="";e?(this.client.setAccessToken(e),this.auth=!0):window.location.href="".concat("https://accounts.spotify.com/authorize","?client_id=").concat("41e10dc3f3594667b190b3681fdee8ca","&redirect_uri=").concat("https://spotifyroulette.paulocorreia.me","&scope=").concat(["user-top-read","user-modify-playback-state","user-read-playback-state"].join("%20"),"&response_type=token&show_dialog=true")}},{key:"search",value:function(){var e=Object(m.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.controller.search(t,this.client);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"play",value:function(e){""!==this.deviceId&&void 0!==e&&(this.client.setShuffle(e.shuffle),this.client.play(Object(u.a)({device_id:this.deviceId},e.playParameters)).catch())}},{key:"hasPlayerOpen",value:function(){var e=Object(m.a)(f.a.mark(function e(){var t;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.client.getMyDevices();case 2:if(0!==(t=e.sent).devices.length){e.next=7;break}return e.abrupt("return",!1);case 7:if(null===t.devices[0].id){e.next=12;break}return this.deviceId=t.devices[0].id,e.abrupt("return",!0);case 12:return e.abrupt("return",!1);case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"isAuthenticated",value:function(){return this.auth}}]),e}(),E=(n(26),n(27),n(13)),O=n.n(E),k=(n(28),function(e){return r.a.createElement("div",{className:"result",onClick:e.onClick},r.a.createElement("img",{className:"cover",src:e.image,alt:"".concat(e.title," Album Cover")}),r.a.createElement("div",{className:"info"},r.a.createElement("h2",{className:"title"},e.title),r.a.createElement("p",{className:"artist"},e.author)))}),y=function(e){var t=Object(c.useRef)(null),n=Object(c.useState)(""),a=Object(o.a)(n,2),s=a[0],i=a[1],u=Object(c.useState)(""),l=Object(o.a)(u,2),f=l[0],m=l[1],h=Object(c.useCallback)(function(e){e&&0===f.length?i("focused"):e||f.length>0?i("focused"):i("")},[f.length]),d=Object(c.useCallback)(function(){null!==f&&""!==f&&e.onSearch(f)},[f,e]);Object(c.useEffect)(function(){var e=t.current,n=function(){return h(!0)},a=function(){return h(!1)},c=function(e){"Enter"===e.key&&d()};return null!==e&&(e.addEventListener("focus",n),e.addEventListener("focusout",a),e.addEventListener("keypress",c)),function(){null!==e&&(e.removeEventListener("focus",n),e.removeEventListener("focusout",a),e.removeEventListener("keypress",c))}},[d,h]),Object(c.useEffect)(function(){e.locked&&i("")},[e.locked]);var p=0===e.searchResult.results.length?r.a.createElement("div",{className:"noResult"},r.a.createElement("h2",{className:"title"},"No result found.")):e.searchResult.results.map(function(t,n){return r.a.createElement(k,Object.assign({key:n},t,{onClick:function(){return t=n,m(""),void e.onResultClick(t);var t}}))});return r.a.createElement("div",{className:"input ".concat(s),style:{height:"".concat(e.searchResult.display?0===e.searchResult.results.length?144:88+64*e.searchResult.results.length+8:88,"px")}},r.a.createElement("div",{className:"searchBar"},r.a.createElement("input",{type:"text",ref:t,value:f,onChange:function(e){m(e.target.value)},placeholder:e.tooltip,disabled:e.locked}),r.a.createElement("button",{onClick:d},r.a.createElement("img",{src:O.a,alt:""}))),e.searchResult.display&&r.a.createElement("div",{className:"results"},p))},g=n(6),j=(n(10),n(14)),S=n.n(j),w=function(e){return function(e){var t=Object(c.useRef)(new g.Howl({src:"/audio/load.mp3"}));Object(c.useEffect)(function(){e&&t.current.play()},[e])}(e.loading),function(e,t){var n=Object(c.useRef)(new g.Howl({src:5===t?"/audio/shot.mp3":"/audio/blank.mp3"}));Object(c.useEffect)(function(){e&&n.current.play()},[e])}(e.shot,e.position),r.a.createElement("div",{className:"container",style:{transform:"rotate(".concat(-60*e.position,"deg)")}},r.a.createElement("div",{className:"cover ".concat(e.load&&"load")},r.a.createElement("img",{className:e.shot?"shot":"",src:e.src,alt:""})))};!function(e){e.EMPTY="empty",e.HALF="half",e.FULL="full"}(a||(a={}));var N,R,C=function(e){var t=Object(c.useState)(-1),n=Object(o.a)(t,2),s=n[0],i=n[1],u=Object(c.useState)(0),l=Object(o.a)(u,2),f=l[0],m=l[1],h=Object(c.useState)(a.EMPTY),d=Object(o.a)(h,2),p=d[0],b=d[1],v=function(e){var t=Object(c.useState)(-1),n=Object(o.a)(t,2),a=n[0],r=n[1];Object(c.useEffect)(function(){setTimeout(function(){e?(a>=0&&a<4&&s(),5===a&&s()):a>=0&&a<6&&s()},1500)},[a,e]);var s=function(){return r(function(e){return e+1})};return[a,s,function(){return r(-1)}]}(e.chooseBullet),E=Object(o.a)(v,3),O=E[0],k=E[1],y=E[2];!function(e){var t=Object(c.useRef)(new g.Howl({src:"/audio/spin.mp3"}));Object(c.useEffect)(function(){e&&t.current.play()},[e])}(e.state===R.SPINING);var j=[e.blank,e.blank,e.blank,e.blank,e.blank,e.bullet].map(function(t,n){return r.a.createElement(w,{key:n,src:void 0!==t?t.image:"",position:n,shot:n===s&&e.state===R.SHOT,load:n<=O,loading:n===O&&e.state===R.LOADING})}),N=function(t,n){k(),setTimeout(function(){t()},n),e.setState(R.LOADING)},C=function(){i(-1),m(0),y(),b(a.EMPTY)},L=function(e){document.documentElement.style.setProperty("--previous","".concat(e))};Object(c.useEffect)(function(){if(e.state===R.LOAD)e.chooseBullet?p===a.EMPTY?N(function(){b(a.HALF),m(5),e.setState(R.IDLE)},7500):p===a.HALF?N(function(){e.setState(R.READY),b(a.FULL),L(5)},500):C():(C(),N(function(){m(5),e.setState(R.READY),b(a.FULL),L(5)},8300));else if(e.state===R.SPIN&&p===a.FULL){var t=A();setTimeout(function(){m(t),e.setState(R.SHOT)},1700),e.setState(R.SPINING)}else e.state===R.SHOT?(L(s),e.onShoot(5===s)):e.state===R.RESET&&(C(),e.setState(R.IDLE))});var A=function(){var e=Math.floor(6*Math.random());return document.documentElement.style.setProperty("--next","".concat(e)),i(e),e};return r.a.createElement("div",{className:"roulette ".concat(e.state," ").concat(p),style:{transform:"rotate(calc(60deg * ".concat(f,"))")}},j,r.a.createElement("img",{src:S.a,alt:""}))},L=(n(29),n(15)),A=n.n(L),I=n(7),x=n.n(I),T=function(e){return r.a.createElement("div",{className:"actionButtonContainer ".concat(e.visible?"visible":"")},r.a.createElement("button",{className:"actionButton",onClick:e.onResetClick},r.a.createElement("img",{src:x.a,alt:""})),r.a.createElement("button",{className:"actionButton",onClick:e.onRerollClick},r.a.createElement("img",{src:A.a,alt:""})))},D=n(16),P=n.n(D),B=function e(t,n){Object(h.a)(this,e),this.display=t,this.results=n},H=function(){function e(){Object(h.a)(this,e)}return Object(d.a)(e,[{key:"search",value:function(){var e=Object(m.a)(f.a.mark(function e(t,n){var a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.searchTracks(t);case 2:return a=e.sent,e.abrupt("return",new B(!0,a.tracks.items.slice(0,3).map(this.formatResult)));case 4:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"formatResult",value:function(e){return{title:e.name,author:e.artists[0].name,image:e.album.images[0].url,playParameters:{uris:[e.uri]},shuffle:!1}}}]),e}(),M=function(){function e(){Object(h.a)(this,e)}return Object(d.a)(e,[{key:"search",value:function(){var e=Object(m.a)(f.a.mark(function e(t,n){var a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.searchAlbums(t);case 2:return a=e.sent,e.abrupt("return",new B(!0,a.albums.items.slice(0,3).map(this.formatResult)));case 4:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"formatResult",value:function(e){return{title:e.name,author:e.artists[0].name,image:e.images.length>0?e.images[0].url:"",playParameters:{context_uri:e.uri},shuffle:!1}}}]),e}(),Y=function(){function e(){Object(h.a)(this,e)}return Object(d.a)(e,[{key:"search",value:function(){var e=Object(m.a)(f.a.mark(function e(t,n){var a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.searchArtists(t);case 2:return a=e.sent,e.abrupt("return",new B(!0,a.artists.items.slice(0,3).map(this.formatResult)));case 4:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"formatResult",value:function(e){return{title:e.name,author:"Artist",image:e.images.length>0?e.images[0].url:"",playParameters:{context_uri:e.uri},shuffle:!0}}}]),e}(),F=(n(30),n(17)),G=n.n(F),_=function(e){return r.a.createElement("div",{className:"warningDialog ".concat(e.visible?"visible":"hidden")},r.a.createElement("img",{src:G.a,alt:"Warning"}),r.a.createElement("h2",null,"Spotify not found"),r.a.createElement("p",null,"Make sure you have spotify open and press retry. If you continue no song will play."),r.a.createElement("button",{className:"retry",onClick:e.onRetryClick},"Retry"),r.a.createElement("button",{className:"continue",onClick:e.onContinueClick},"continue"))},U=(n(31),n(32),function(e){var t=e.chips.map(function(t,n){return r.a.createElement("div",{key:n,className:"chip ".concat(n===e.selected?"selected":""),onClick:function(){return e.onSelect(n)}},t)});return r.a.createElement("div",{className:"chipContainer"},t)}),W=function(e){return r.a.createElement("div",{className:"settingsDialog ".concat(e.visible?"visible":"hidden")},r.a.createElement("h2",null,"Settings"),r.a.createElement("h3",null,"Bullet Type"),r.a.createElement(U,{selected:e.bulletType,chips:["Songs","Albuns","Artists"],onSelect:e.setBulletType}),r.a.createElement("img",{className:"close",src:x.a,onClick:e.toggleVisibility,alt:""}))};!function(e){e[e.Songs=0]="Songs",e[e.Albums=1]="Albums",e[e.Artists=2]="Artists"}(N||(N={})),function(e){e.RESET="reset",e.IDLE="idle",e.LOAD="load",e.LOADING="loading",e.READY="ready",e.SPIN="spin",e.SPINING="spining",e.SHOT="shot"}(R||(R={}));var J=function(){var e=Object(c.useRef)(new v(new H)),t=Object(c.useState)(R.IDLE),n=Object(o.a)(t,2),a=n[0],s=n[1],i=Object(c.useState)(),u=Object(o.a)(i,2),l=u[0],f=u[1],m=Object(c.useState)(),h=Object(o.a)(m,2),d=h[0],p=h[1],b=Object(c.useState)(N.Songs),E=Object(o.a)(b,2),O=E[0],k=E[1],g=Object(c.useState)(new B(!1,[])),j=Object(o.a)(g,2),S=j[0],w=j[1],L=function(e,t,n){var a=Object(c.useState)(),r=Object(o.a)(a,2),s=r[0],i=r[1],u=Object(c.useCallback)(function(){return e.hasPlayerOpen().then(function(e){i(e)})},[e]);return Object(c.useEffect)(function(){t===R.READY&&(s?n(R.SPIN):u())},[s,u,t,n]),[s,u,i]}(e.current,a,s),A=Object(o.a)(L,3),I=A[0],x=A[1],D=A[2],F=function(){var e=Object(c.useState)(!1),t=Object(o.a)(e,2),n=t[0],a=t[1];return[n,function(){a(!n)}]}(),G=Object(o.a)(F,2),U=G[0],J=G[1];Object(c.useEffect)(function(){switch(O){case N.Songs:e.current.setController(new H);break;case N.Albums:e.current.setController(new M);break;case N.Artists:e.current.setController(new Y)}},[O]),Object(c.useEffect)(function(){e.current.isAuthenticated()||e.current.authenticateUser()},[]);return r.a.createElement("div",{className:"app"},r.a.createElement("div",{className:"controls"},r.a.createElement(y,{searchResult:S,onSearch:function(t){e.current.search(t).then(function(e){return w(e)})},onResultClick:function(e){void 0===d?p(S.results[e]):f(S.results[e]),w(new B(!1,[])),s(R.LOAD)},locked:a!==R.IDLE,tooltip:a===R.IDLE?void 0===d?"Search for the blanks":"Search for the bullet!":a===R.LOADING?"Loading weapon.":a===R.SHOT?"Reset or Reroll":""}),r.a.createElement(T,{visible:a===R.SHOT,onRerollClick:function(){return s(R.SPIN)},onResetClick:function(){f(void 0),p(void 0),s(R.RESET)}})),r.a.createElement(C,{blank:d,bullet:l,state:a,setState:s,chooseBullet:!0,onShoot:function(t){e.current.play(t?l:d)}}),r.a.createElement("img",{className:"settingsButton",src:P.a,onClick:J,alt:""}),r.a.createElement(_,{visible:!I&&void 0!==I,onRetryClick:x,onContinueClick:function(){s(R.SPIN),D(!0)}}),r.a.createElement(W,{visible:U,toggleVisibility:J,bulletType:O,setBulletType:k}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(J,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}],[[19,1,2]]]);
//# sourceMappingURL=main.745784bf.chunk.js.map