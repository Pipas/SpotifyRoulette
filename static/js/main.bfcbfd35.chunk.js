(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,function(e,t,n){e.exports=n.p+"static/media/close.e85191c6.svg"},,,,function(e,t,n){},,,,function(e,t,n){e.exports=n.p+"static/media/search.97161617.svg"},function(e,t,n){e.exports=n.p+"static/media/roulette.dc8d006c.svg"},function(e,t,n){e.exports=n.p+"static/media/spin.8f3bc11a.svg"},function(e,t,n){e.exports=n.p+"static/media/settings.7c9f5af4.svg"},,function(e,t,n){e.exports=n.p+"static/media/warning.34c3adc3.svg"},,,,function(e,t,n){e.exports=n(36)},,,,,function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a,c=n(0),s=n.n(c),i=n(10),r=n.n(i),o=(n(27),n(1)),l=n(6),u=n.n(l),f=n(11),m=n(20),d=n(2),h=n(4),b=n(12),p=n.n(b),v=function(){function e(){Object(d.a)(this,e),this.client=void 0,this.auth=!1,this.deviceId="",this.client=new p.a}return Object(h.a)(e,[{key:"authenticateUser",value:function(){var e=window.location.hash.substring(1).split("&")[0].split("=")[1];window.location.hash="";e?(this.client.setAccessToken(e),this.auth=!0):window.location.href="".concat("https://accounts.spotify.com/authorize","?client_id=").concat("41e10dc3f3594667b190b3681fdee8ca","&redirect_uri=").concat("https://spotifyroulette.paulocorreia.me","&scope=").concat(["user-top-read","user-modify-playback-state","user-read-playback-state"].join("%20"),"&response_type=token&show_dialog=true")}},{key:"searchTrack",value:function(e){return this.client.searchTracks(e)}},{key:"play",value:function(e){""!==this.deviceId&&this.client.play(Object(m.a)({device_id:this.deviceId},e)).catch()}},{key:"hasPlayerOpen",value:function(){var e=Object(f.a)(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.client.getMyDevices();case 2:if(0!==(t=e.sent).devices.length){e.next=7;break}return e.abrupt("return",!1);case 7:if(null===t.devices[0].id){e.next=12;break}return this.deviceId=t.devices[0].id,e.abrupt("return",!0);case 12:return e.abrupt("return",!1);case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"isAuthenticated",value:function(){return this.auth}}]),e}(),E=(n(29),n(30),n(13)),O=n.n(E),y=(n(31),function(e){return s.a.createElement("div",{className:"result",onClick:e.onClick},s.a.createElement("img",{className:"cover",src:e.src,alt:"".concat(e.title," Album Cover")}),s.a.createElement("div",{className:"info"},s.a.createElement("h2",{className:"title"},e.title),s.a.createElement("p",{className:"artist"},e.author)))}),k=function(e){var t=Object(c.useRef)(null),n=Object(c.useState)(""),a=Object(o.a)(n,2),i=a[0],r=a[1],l=Object(c.useState)(""),u=Object(o.a)(l,2),f=u[0],m=u[1],d=Object(c.useCallback)(function(e){e&&0===f.length?r("focused"):e||f.length>0?r("focused"):r("")},[f.length]),h=Object(c.useCallback)(function(){null!==f&&""!==f&&e.onSearch(f)},[f,e]);Object(c.useEffect)(function(){var e=t.current,n=function(){return d(!0)},a=function(){return d(!1)},c=function(e){"Enter"===e.key&&h()};return null!==e&&(e.addEventListener("focus",n),e.addEventListener("focusout",a),e.addEventListener("keypress",c)),function(){null!==e&&(e.removeEventListener("focus",n),e.removeEventListener("focusout",a),e.removeEventListener("keypress",c))}},[h,d]),Object(c.useEffect)(function(){e.locked&&r("")},[e.locked]);var b=0===e.searchResult.results.length?s.a.createElement("div",{className:"noResult"},s.a.createElement("h2",{className:"title"},"No result found.")):e.searchResult.results.map(function(t,n){return s.a.createElement(y,Object.assign({key:n},t,{onClick:function(){return t=n,m(""),void e.onResultClick(t);var t}}))});return s.a.createElement("div",{className:"input ".concat(i),style:{height:"".concat(e.searchResult.display?0===e.searchResult.results.length?144:88+64*e.searchResult.results.length+8:88,"px")}},s.a.createElement("div",{className:"searchBar"},s.a.createElement("input",{type:"text",ref:t,value:f,onChange:function(e){m(e.target.value)},placeholder:e.tooltip,disabled:e.locked}),s.a.createElement("button",{onClick:h},s.a.createElement("img",{src:O.a,alt:""}))),e.searchResult.display&&s.a.createElement("div",{className:"results"},b))},g=n(3),j=(n(9),n(14)),S=n.n(j),N=function(e){return function(e){var t=Object(c.useRef)(new g.Howl({src:"/audio/load.mp3"}));Object(c.useEffect)(function(){e&&t.current.play()},[e])}(e.loading),function(e,t){var n=Object(c.useRef)(new g.Howl({src:5===t?"/audio/shot.mp3":"/audio/blank.mp3"}));Object(c.useEffect)(function(){e&&n.current.play()},[e])}(e.shot,e.position),s.a.createElement("div",{className:"container",style:{transform:"rotate(".concat(-60*e.position,"deg)")}},s.a.createElement("div",{className:"cover ".concat(e.load&&"load")},s.a.createElement("img",{className:e.shot?"shot":"",src:e.src,alt:""})))};!function(e){e.EMPTY="empty",e.HALF="half",e.FULL="full"}(a||(a={}));var w,R,L=function(e){var t=Object(c.useState)(-1),n=Object(o.a)(t,2),i=n[0],r=n[1],l=Object(c.useState)(0),u=Object(o.a)(l,2),f=u[0],m=u[1],d=Object(c.useState)(a.EMPTY),h=Object(o.a)(d,2),b=h[0],p=h[1],v=function(e){var t=Object(c.useState)(-1),n=Object(o.a)(t,2),a=n[0],s=n[1];Object(c.useEffect)(function(){setTimeout(function(){e?(a>=0&&a<4&&i(),5===a&&i()):a>=0&&a<6&&i()},1500)},[a,e]);var i=function(){return s(function(e){return e+1})};return[a,i,function(){return s(-1)}]}(e.chooseBullet),E=Object(o.a)(v,3),O=E[0],y=E[1],k=E[2];!function(e){var t=Object(c.useRef)(new g.Howl({src:"/audio/spin.mp3"}));Object(c.useEffect)(function(){e&&t.current.play()},[e])}(e.state===R.SPINING);var j=[e.blank,e.blank,e.blank,e.blank,e.blank,e.bullet].map(function(t,n){return s.a.createElement(N,{key:n,src:t,position:n,shot:n===i&&e.state===R.SHOT,load:n<=O,loading:n===O&&e.state===R.LOADING})}),w=function(t,n){y(),setTimeout(function(){t()},n),e.setState(R.LOADING)},L=function(){r(-1),m(0),k(),p(a.EMPTY)},C=function(e){document.documentElement.style.setProperty("--previous","".concat(e))};Object(c.useEffect)(function(){if(e.state===R.LOAD)e.chooseBullet?b===a.EMPTY?w(function(){p(a.HALF),m(5),e.setState(R.IDLE)},7500):b===a.HALF?w(function(){e.setState(R.READY),p(a.FULL),C(5)},500):L():(L(),w(function(){m(5),e.setState(R.READY),p(a.FULL),C(5)},8300));else if(e.state===R.SPIN&&b===a.FULL){var t=I();setTimeout(function(){m(t),e.setState(R.SHOT)},1700),e.setState(R.SPINING)}else e.state===R.SHOT?(C(i),e.onShoot(5===i)):e.state===R.RESET&&(L(),e.setState(R.IDLE))});var I=function(){var e=Math.floor(6*Math.random());return document.documentElement.style.setProperty("--next","".concat(e)),r(e),e};return s.a.createElement("div",{className:"roulette ".concat(e.state," ").concat(b),style:{transform:"rotate(calc(60deg * ".concat(f,"))")}},j,s.a.createElement("img",{src:S.a,alt:""}))},C=(n(32),n(15)),I=n.n(C),T=n(5),A=n.n(T),D=function(e){return s.a.createElement("div",{className:"actionButtonContainer ".concat(e.visible?"visible":"")},s.a.createElement("button",{className:"actionButton",onClick:e.onResetClick},s.a.createElement("img",{src:A.a,alt:""})),s.a.createElement("button",{className:"actionButton",onClick:e.onRerollClick},s.a.createElement("img",{src:I.a,alt:""})))},P=n(16),x=n.n(P),B=n(19),H=n(17),M=n(21),Y=function e(t,n){Object(d.a)(this,e),this.display=t,this.results=n},F=function e(t,n){Object(d.a)(this,e),this.display=t,this.results=n},G=function(e){function t(){return Object(d.a)(this,t),Object(B.a)(this,Object(H.a)(t).apply(this,arguments))}return Object(M.a)(t,e),Object(h.a)(t,[{key:"search",value:function(e){var t=this;this.spotify.searchTrack(e).then(function(e){t.setResults(new Y(!0,e.tracks.items.slice(0,3)))})}},{key:"formatResults",value:function(e){return new F(e.display,e.results.map(function(e){return{title:e.name,author:e.artists[0].name,src:e.album.images[0].url}}))}},{key:"getItemSrc",value:function(e){return void 0===e?"":e.album.images[0].url}},{key:"play",value:function(e){this.spotify.play({uris:[e.uri]})}}]),t}(function e(t,n){Object(d.a)(this,e),this.spotify=t,this.setResults=n}),U=(n(33),n(18)),_=n.n(U),W=function(e){return s.a.createElement("div",{className:"warningDialog ".concat(e.visible?"visible":"hidden")},s.a.createElement("img",{src:_.a,alt:"Warning"}),s.a.createElement("h2",null,"Spotify not found"),s.a.createElement("p",null,"Make sure you have spotify open and press retry. If you continue no song will play."),s.a.createElement("button",{className:"retry",onClick:e.onRetryClick},"Retry"),s.a.createElement("button",{className:"continue",onClick:e.onContinueClick},"continue"))},J=(n(34),n(35),function(e){var t=e.chips.map(function(t,n){return s.a.createElement("div",{key:n,className:"chip ".concat(n===e.selected?"selected":""),onClick:function(){return e.onSelect(n)}},t)});return s.a.createElement("div",{className:"chipContainer"},t)}),V=function(e){return s.a.createElement("div",{className:"settingsDialog ".concat(e.visible?"visible":"hidden")},s.a.createElement("h2",null,"Settings"),s.a.createElement("h3",null,"Bullet Type"),s.a.createElement(J,{selected:e.bulletType,chips:["Songs","Albuns","Artists"],onSelect:e.setBulletType}),s.a.createElement("img",{className:"close",src:A.a,onClick:e.toggleVisibility,alt:""}))};!function(e){e[e.Songs=0]="Songs",e[e.Albums=1]="Albums",e[e.Artists=2]="Artists"}(w||(w={})),function(e){e.RESET="reset",e.IDLE="idle",e.LOAD="load",e.LOADING="loading",e.READY="ready",e.SPIN="spin",e.SPINING="spining",e.SHOT="shot"}(R||(R={}));var z=function(){var e=Object(c.useRef)(new v),t=Object(c.useState)(R.IDLE),n=Object(o.a)(t,2),a=n[0],i=n[1],r=Object(c.useState)(new Y(!1,[])),l=Object(o.a)(r,2),u=l[0],f=l[1],m=Object(c.useState)(),d=Object(o.a)(m,2),h=d[0],b=d[1],p=Object(c.useState)(),E=Object(o.a)(p,2),O=E[0],y=E[1],g=Object(c.useRef)(new G(e.current,f)),j=function(e,t,n){var a=Object(c.useState)(),s=Object(o.a)(a,2),i=s[0],r=s[1],l=Object(c.useCallback)(function(){return e.hasPlayerOpen().then(function(e){r(e)})},[e]);return Object(c.useEffect)(function(){t===R.READY&&(i?n(R.SPIN):l())},[i,l,t,n]),[i,l,r]}(e.current,a,i),S=Object(o.a)(j,3),N=S[0],C=S[1],I=S[2],T=function(){var e=Object(c.useState)(!1),t=Object(o.a)(e,2),n=t[0],a=t[1];return[n,function(){a(!n)}]}(),A=Object(o.a)(T,2),P=A[0],B=A[1],H=Object(c.useState)(w.Songs),M=Object(o.a)(H,2),F=M[0],U=M[1];Object(c.useEffect)(function(){e.current.isAuthenticated()||e.current.authenticateUser()},[]);return s.a.createElement("div",{className:"app"},s.a.createElement("div",{className:"controls"},s.a.createElement(k,{searchResult:g.current.formatResults(u),onSearch:function(e){return g.current.search(e)},onResultClick:function(e){void 0===O?y(u.results[e]):b(u.results[e]),f(new Y(!1,[])),i(R.LOAD)},locked:a!==R.IDLE,tooltip:a===R.IDLE?void 0===O?"Search for the blanks":"Search for the bullet!":a===R.LOADING?"Loading weapon.":a===R.SHOT?"Reset or Reroll":""}),s.a.createElement(D,{visible:a===R.SHOT,onRerollClick:function(){return i(R.SPIN)},onResetClick:function(){b(void 0),y(void 0),i(R.RESET)}})),s.a.createElement(L,{blank:g.current.getItemSrc(O),bullet:g.current.getItemSrc(h),state:a,setState:i,chooseBullet:!0,onShoot:function(e){g.current.play(e?h:O)}}),s.a.createElement("img",{className:"settingsButton",src:x.a,onClick:B,alt:""}),s.a.createElement(W,{visible:!N&&void 0!==N,onRetryClick:C,onContinueClick:function(){i(R.SPIN),I(!0)}}),s.a.createElement(V,{visible:P,toggleVisibility:B,bulletType:F,setBulletType:U}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(s.a.createElement(z,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}],[[22,1,2]]]);
//# sourceMappingURL=main.bfcbfd35.chunk.js.map