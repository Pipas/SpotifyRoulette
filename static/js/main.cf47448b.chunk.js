(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,,,,,function(e,t,n){},function(e,t,n){},,,function(e,t,n){e.exports=n.p+"static/media/search.9df51d4e.svg"},function(e,t,n){e.exports=n.p+"static/media/settings.85c5dd08.svg"},function(e,t,n){e.exports=n.p+"static/media/roulette.dc8d006c.svg"},function(e,t,n){e.exports=n.p+"static/media/reload.2991144a.svg"},function(e,t,n){e.exports=n.p+"static/media/reshoot.99a86319.svg"},function(e,t,n){e.exports=n.p+"static/media/warning.6b87cfa4.svg"},function(e,t,n){e.exports=n.p+"static/media/close.e85191c6.svg"},function(e,t,n){e.exports=n.p+"static/media/logo.7fee23ab.png"},,function(e,t,n){e.exports=n(36)},,,,,function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a,c=n(0),r=n.n(c),s=n(11),i=n.n(s),o=(n(27),n(1)),u=n(21),l=n(2),f=n.n(l),m=n(3),h=n(4),d=n(5),p=n(12),b=n.n(p),v=function(){function e(t){Object(h.a)(this,e),this.client=void 0,this.auth=!1,this.deviceId="",this.controller=void 0,this.client=new b.a,this.controller=t}return Object(d.a)(e,[{key:"setController",value:function(e){this.controller=e}},{key:"authenticateUser",value:function(){var e=window.location.hash.substring(1).split("&")[0].split("=")[1];window.location.hash="";e?(this.client.setAccessToken(e),this.auth=!0):window.location.href="".concat("https://accounts.spotify.com/authorize","?client_id=").concat("41e10dc3f3594667b190b3681fdee8ca","&redirect_uri=").concat("https://spotifyroulette.paulocorreia.me","&scope=").concat(["user-top-read","user-modify-playback-state","user-read-playback-state"].join("%20"),"&response_type=token&show_dialog=true")}},{key:"search",value:function(){var e=Object(m.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.controller.search(t,this.client);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"play",value:function(e){""!==this.deviceId&&void 0!==e&&(this.client.setShuffle(e.shuffle),this.client.play(Object(u.a)({device_id:this.deviceId},e.playParameters)).catch())}},{key:"hasPlayerOpen",value:function(){var e=Object(m.a)(f.a.mark(function e(){var t;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.client.getMyDevices();case 2:if(0!==(t=e.sent).devices.length){e.next=7;break}return e.abrupt("return",!1);case 7:if(null===t.devices[0].id){e.next=12;break}return this.deviceId=t.devices[0].id,e.abrupt("return",!0);case 12:return e.abrupt("return",!1);case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"isAuthenticated",value:function(){return this.auth}}]),e}(),E=(n(29),n(30),n(13)),g=n.n(E),O=n(14),k=n.n(O),y=function(e){var t=Object(c.useRef)(null),n=Object(c.useState)(""),a=Object(o.a)(n,2),s=a[0],i=a[1],u=Object(c.useCallback)(function(){null!==s&&""!==s&&e.onSearch(s)},[s,e]);Object(c.useEffect)(function(){var e=t.current,n=function(e){"Enter"===e.key&&u()};return null!==e&&e.addEventListener("keypress",n),function(){null!==e&&e.removeEventListener("keypress",n)}},[u]),Object(c.useEffect)(function(){e.locked&&i("")},[e.locked]);return r.a.createElement("div",{className:"buttonContainer"},r.a.createElement("div",{className:"searchBar"},r.a.createElement("button",{onClick:u},r.a.createElement("img",{src:g.a,alt:""})),r.a.createElement("input",{type:"text",ref:t,value:s,onChange:function(t){i(t.target.value),""===t.target.value&&e.onQueryChange()},placeholder:e.tooltip,disabled:e.locked})),r.a.createElement("img",{className:"settingsButton",src:k.a,onClick:e.onSettingsClick,alt:""}))},S=n(6),j=(n(9),n(15)),w=n.n(j),N=function(e){return function(e){var t=Object(c.useRef)(new S.Howl({src:"/audio/load.mp3"}));Object(c.useEffect)(function(){e&&t.current.play()},[e])}(e.loading),function(e,t){var n=Object(c.useRef)(new S.Howl({src:5===t?"/audio/shot.mp3":"/audio/blank.mp3"}));Object(c.useEffect)(function(){e&&n.current.play()},[e])}(e.shot,e.position),r.a.createElement("div",{className:"container",style:{transform:"rotate(".concat(-60*e.position,"deg)")}},r.a.createElement("div",{className:"cover ".concat(e.load&&"load")},r.a.createElement("img",{className:e.shot?"shot":"",src:e.src,alt:""})))};!function(e){e.EMPTY="empty",e.HALF="half",e.FULL="full"}(a||(a={}));var C,R,A=function(e){var t=Object(c.useState)(-1),n=Object(o.a)(t,2),s=n[0],i=n[1],u=Object(c.useState)(0),l=Object(o.a)(u,2),f=l[0],m=l[1],h=Object(c.useState)(a.EMPTY),d=Object(o.a)(h,2),p=d[0],b=d[1],v=function(e){var t=Object(c.useState)(-1),n=Object(o.a)(t,2),a=n[0],r=n[1];Object(c.useEffect)(function(){setTimeout(function(){e?(a>=0&&a<4&&s(),5===a&&s()):a>=0&&a<6&&s()},1500)},[a,e]);var s=function(){return r(function(e){return e+1})};return[a,s,function(){return r(-1)}]}(e.chooseBullet),E=Object(o.a)(v,3),g=E[0],O=E[1],k=E[2];!function(e){var t=Object(c.useRef)(new S.Howl({src:"/audio/spin.mp3"}));Object(c.useEffect)(function(){e&&t.current.play()},[e])}(e.state===R.SPINING);var y=[e.blank,e.blank,e.blank,e.blank,e.blank,e.bullet].map(function(t,n){return r.a.createElement(N,{key:n,src:void 0!==t?t.image:"",position:n,shot:n===s&&e.state===R.SHOOTING,load:n<=g,loading:n===g&&e.state===R.LOADING})}),j=function(t,n){O(),setTimeout(function(){t()},n),e.setState(R.LOADING)},C=function(){i(-1),m(0),k(),b(a.EMPTY)},A=function(e){document.documentElement.style.setProperty("--previous","".concat(e))};Object(c.useEffect)(function(){if(e.state===R.LOAD)e.chooseBullet?p===a.EMPTY?j(function(){b(a.HALF),m(5),e.setState(R.IDLE)},7500):p===a.HALF?j(function(){e.setState(R.READY),b(a.FULL),A(5)},500):C():(C(),j(function(){m(5),e.setState(R.READY),b(a.FULL),A(5)},8300));else if(e.state===R.SPIN&&p===a.FULL){var t=I();setTimeout(function(){m(t),e.setState(R.SHOOTING)},1700),e.setState(R.SPINING)}else e.state===R.SHOOTING?(A(s),e.onShoot(5===s),e.setState(R.SHOT)):e.state===R.RESET&&(C(),e.setState(R.IDLE))});var I=function(){var e=Math.floor(6*Math.random());return document.documentElement.style.setProperty("--next","".concat(e)),i(e),e};return r.a.createElement("div",{className:"roulette ".concat(e.state," ").concat(p),style:{transform:"rotate(calc(60deg * ".concat(f,"))")}},y,r.a.createElement("img",{src:w.a,alt:""}))},I=(n(31),n(16)),L=n.n(I),T=n(17),x=n.n(T),P=function(e){return r.a.createElement("div",{className:"actionButtonContainer ".concat(e.visible?"visible":"")},r.a.createElement("button",{className:"actionButton",onClick:e.onResetClick},r.a.createElement("img",{src:L.a,alt:""}),"Reset Gun."),r.a.createElement("button",{className:"actionButton",onClick:e.onRerollClick},r.a.createElement("img",{src:x.a,alt:""}),"Shoot again!"))},D=function e(t,n){Object(h.a)(this,e),this.display=t,this.results=n},H=function(){function e(){Object(h.a)(this,e)}return Object(d.a)(e,[{key:"search",value:function(){var e=Object(m.a)(f.a.mark(function e(t,n){var a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.searchTracks(t);case 2:return a=e.sent,e.abrupt("return",new D(!0,a.tracks.items.slice(0,3).map(this.formatResult)));case 4:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"formatResult",value:function(e){return{title:e.name,author:e.artists[0].name,image:e.album.images[0].url,playParameters:{uris:[e.uri]},shuffle:!1}}}]),e}(),B=function(){function e(){Object(h.a)(this,e)}return Object(d.a)(e,[{key:"search",value:function(){var e=Object(m.a)(f.a.mark(function e(t,n){var a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.searchAlbums(t);case 2:return a=e.sent,e.abrupt("return",new D(!0,a.albums.items.slice(0,3).map(this.formatResult)));case 4:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"formatResult",value:function(e){return{title:e.name,author:e.artists[0].name,image:e.images.length>0?e.images[0].url:"",playParameters:{context_uri:e.uri},shuffle:!1}}}]),e}(),G=function(){function e(){Object(h.a)(this,e)}return Object(d.a)(e,[{key:"search",value:function(){var e=Object(m.a)(f.a.mark(function e(t,n){var a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.searchArtists(t);case 2:return a=e.sent,e.abrupt("return",new D(!0,a.artists.items.slice(0,3).map(this.formatResult)));case 4:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"formatResult",value:function(e){return{title:e.name,author:"Artist",image:e.images.length>0?e.images[0].url:"",playParameters:{context_uri:e.uri},shuffle:!0}}}]),e}(),M=(n(32),n(18)),Y=n.n(M),F=function(e){return r.a.createElement("div",{className:"warningDialog ".concat(e.visible?"visible":"hidden")},r.a.createElement("img",{src:Y.a,alt:"Warning"}),r.a.createElement("h2",null,"Spotify not found"),r.a.createElement("p",null,"Make sure you have spotify open and press retry. If you continue no song will play."),r.a.createElement("button",{className:"retry",onClick:e.onRetryClick},"Retry"),r.a.createElement("button",{className:"continue",onClick:e.onContinueClick},"continue"))},_=(n(33),n(19)),U=n.n(_),V=(n(34),function(e){var t=e.chips.map(function(t,n){return r.a.createElement("div",{key:n,className:"chip ".concat(n===e.selected?"selected":""),onClick:function(){return e.onSelect(n)}},t)});return r.a.createElement("div",{className:"chipContainer"},t)}),W=function(e){return r.a.createElement("div",{className:"settingsContainer ".concat(e.visible?"visible":"hidden"),onClick:e.toggleVisibility},r.a.createElement("div",{className:"settingsDialog",onClick:function(e){return e.stopPropagation()}},r.a.createElement("h2",null,"Settings"),r.a.createElement("h3",null,"Bullet Type"),r.a.createElement(V,{selected:e.bulletType,chips:["Songs","Albuns","Artists"],onSelect:e.setBulletType}),r.a.createElement("img",{className:"close",src:U.a,onClick:e.toggleVisibility,alt:""})))},J=(n(10),function(e){return r.a.createElement("div",{className:"result",onClick:e.onClick},r.a.createElement("img",{className:"cover",src:e.image,alt:"".concat(e.title," Album Cover")}),r.a.createElement("div",{className:"info"},r.a.createElement("h2",{className:"title"},e.title),r.a.createElement("p",{className:"artist"},e.author)))}),Q=function(e){var t=e.searchResult.results.map(function(t,n){return r.a.createElement(J,Object.assign({key:Math.floor(1e4*Math.random())},t,{onClick:function(){return t=n,void e.onResultClick(t);var t}}))});return e.searchResult.display?e.searchResult.results.length>0?r.a.createElement("div",{className:"results"},t):r.a.createElement("div",{className:"results"},r.a.createElement("div",{className:"noResult"},r.a.createElement("h2",{className:"title"},"No results found."))):null},z=(n(35),n(20)),$=n.n(z),q=function(){return r.a.createElement("div",{className:"siteTitle"},r.a.createElement("img",{src:$.a,alt:""}),r.a.createElement("div",null,r.a.createElement("h1",null,"Spotify"),r.a.createElement("h1",null,"Roulette")))};!function(e){e[e.Songs=0]="Songs",e[e.Albums=1]="Albums",e[e.Artists=2]="Artists"}(C||(C={})),function(e){e.RESET="reset",e.IDLE="idle",e.LOAD="load",e.LOADING="loading",e.READY="ready",e.SPIN="spin",e.SPINING="spining",e.SHOOTING="shooting",e.SHOT="shot"}(R||(R={}));var K=function(){var e=Object(c.useRef)(new v(new H)),t=Object(c.useState)(R.IDLE),n=Object(o.a)(t,2),a=n[0],s=n[1],i=Object(c.useState)(),u=Object(o.a)(i,2),l=u[0],f=u[1],m=Object(c.useState)(),h=Object(o.a)(m,2),d=h[0],p=h[1],b=Object(c.useState)(C.Songs),E=Object(o.a)(b,2),g=E[0],O=E[1],k=Object(c.useState)(new D(!1,[])),S=Object(o.a)(k,2),j=S[0],w=S[1],N=function(e,t,n){var a=Object(c.useState)(),r=Object(o.a)(a,2),s=r[0],i=r[1],u=Object(c.useCallback)(function(){return e.hasPlayerOpen().then(function(e){i(e)})},[e]);return Object(c.useEffect)(function(){t===R.READY&&(s?n(R.SPIN):u())},[s,u,t,n]),[s,u,i]}(e.current,a,s),I=Object(o.a)(N,3),L=I[0],T=I[1],x=I[2],M=function(){var e=Object(c.useState)(!1),t=Object(o.a)(e,2),n=t[0],a=t[1];return[n,function(){a(!n)}]}(),Y=Object(o.a)(M,2),_=Y[0],U=Y[1];Object(c.useEffect)(function(){switch(g){case C.Songs:e.current.setController(new H);break;case C.Albums:e.current.setController(new B);break;case C.Artists:e.current.setController(new G)}},[g]),Object(c.useEffect)(function(){e.current.isAuthenticated()||e.current.authenticateUser()},[]);return r.a.createElement("div",{className:"app"},r.a.createElement(q,null),r.a.createElement("div",{className:"searchContainer"},r.a.createElement(y,{onSearch:function(t){e.current.search(t).then(function(e){return w(e)})},onQueryChange:function(){return w(new D(!1,[]))},onSettingsClick:U,locked:a!==R.IDLE,tooltip:function(){if(a===R.IDLE){if(void 0!==d)return"Search for the bullet!";switch(g){case C.Songs:return"Search for a song to get started";case C.Albums:return"Search for an album to get started";case C.Artists:return"Search for an artist to get started"}}else{if(a===R.LOADING)return"Loading weapon...";if(a===R.SHOT)return"Choose an option"}return""}()}),r.a.createElement(Q,{searchResult:j,onResultClick:function(e){void 0===d?p(j.results[e]):f(j.results[e]),w(new D(!1,[])),s(R.LOAD)}}),r.a.createElement(P,{visible:a===R.SHOT,onRerollClick:function(){return s(R.SPIN)},onResetClick:function(){f(void 0),p(void 0),s(R.RESET)}})),r.a.createElement(A,{blank:d,bullet:l,state:a,setState:s,chooseBullet:!0,onShoot:function(t){e.current.play(t?l:d)}}),r.a.createElement(F,{visible:!L&&void 0!==L,onRetryClick:T,onContinueClick:function(){s(R.SPIN),x(!0)}}),r.a.createElement(W,{visible:_,toggleVisibility:U,bulletType:g,setBulletType:O}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(K,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}],[[22,1,2]]]);
//# sourceMappingURL=main.cf47448b.chunk.js.map