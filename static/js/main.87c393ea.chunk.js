(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,,,function(e,t,n){},,,function(e,t,n){e.exports=n.p+"static/media/search.97161617.svg"},function(e,t,n){e.exports=n.p+"static/media/roulette.dc8d006c.svg"},function(e,t,n){e.exports=n.p+"static/media/spin.8f3bc11a.svg"},,,,function(e,t,n){e.exports=n(26)},,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var c,a=n(0),s=n.n(a),o=n(8),r=n.n(o),u=(n(21),n(1)),i=n(2),l=n(4),f=n(9),m=n.n(f),h=function(){function e(){Object(i.a)(this,e),this.client=void 0,this.auth=!1,this.client=new m.a}return Object(l.a)(e,[{key:"authenticateUser",value:function(){var e=window.location.hash.substring(1).split("&")[0].split("=")[1];window.location.hash="";e?(this.client.setAccessToken(e),this.auth=!0):window.location.href="".concat("https://accounts.spotify.com/authorize","?client_id=").concat("41e10dc3f3594667b190b3681fdee8ca","&redirect_uri=").concat("https://spotifyroulette.paulocorreia.me","&scope=").concat(["user-top-read","user-modify-playback-state"].join("%20"),"&response_type=token&show_dialog=true")}},{key:"searchTrack",value:function(e){return this.client.searchTracks(e)}},{key:"play",value:function(e){return this.client.play(e)}},{key:"isAuthenticated",value:function(){return this.auth}}]),e}(),d=(n(22),n(23),n(10)),b=n.n(d),p=(n(24),function(e){return s.a.createElement("div",{className:"result",onClick:e.onClick},s.a.createElement("img",{className:"cover",src:e.src,alt:"".concat(e.title," Album Cover")}),s.a.createElement("div",{className:"info"},s.a.createElement("h2",{className:"title"},e.title),s.a.createElement("p",{className:"artist"},e.author)))}),v=function(e){var t=Object(a.useRef)(null),n=Object(a.useState)(""),c=Object(u.a)(n,2),o=c[0],r=c[1],i=Object(a.useState)(""),l=Object(u.a)(i,2),f=l[0],m=l[1],h=Object(a.useCallback)(function(e){e&&0===f.length?r("focused"):e||f.length>0?r("focused"):r("")},[f.length]),d=Object(a.useCallback)(function(){null!==f&&""!==f&&e.onSearch(f)},[f,e]);Object(a.useEffect)(function(){var e=t.current,n=function(){return h(!0)},c=function(){return h(!1)},a=function(e){"Enter"===e.key&&d()};return null!==e&&(e.addEventListener("focus",n),e.addEventListener("focusout",c),e.addEventListener("keypress",a)),function(){null!==e&&(e.removeEventListener("focus",n),e.removeEventListener("focusout",c),e.removeEventListener("keypress",a))}},[d,h]),Object(a.useEffect)(function(){e.locked&&r("")},[e.locked]);var v=e.results.map(function(t,n){return s.a.createElement(p,Object.assign({key:n},t,{onClick:function(){return e.onResultClick(n)}}))});return s.a.createElement("div",{className:"input ".concat(o),style:{height:"".concat(88+64*e.results.length+(e.results.length?8:0),"px")}},s.a.createElement("div",{className:"searchBar"},s.a.createElement("input",{type:"text",ref:t,value:f,onChange:function(e){m(e.target.value)},placeholder:"Search",disabled:e.locked}),s.a.createElement("button",{onClick:d},s.a.createElement("img",{src:b.a,alt:""}))),!!e.results.length&&s.a.createElement("div",{className:"results"},v))},O=n(3),E=(n(7),n(11)),j=n.n(E),k=function(e){return function(e){var t=Object(a.useRef)(new O.Howl({src:"/audio/load.mp3"}));Object(a.useEffect)(function(){e&&t.current.play()},[e])}(e.loading),function(e,t){var n=Object(a.useRef)(new O.Howl({src:5===t?"/audio/shot.mp3":"/audio/blank.mp3"}));Object(a.useEffect)(function(){e&&n.current.play()},[e])}(e.shot,e.position),s.a.createElement("div",{className:"container",style:{transform:"rotate(".concat(-60*e.position,"deg)")}},s.a.createElement("div",{className:"cover ".concat(e.load&&"load")},s.a.createElement("img",{className:e.shot?"shot":"",src:e.src,alt:""})))};!function(e){e.EMPTY="empty",e.HALF="half",e.FULL="full"}(c||(c={}));var y,S=function(e){var t=Object(a.useState)(-1),n=Object(u.a)(t,2),o=n[0],r=n[1],i=Object(a.useState)(0),l=Object(u.a)(i,2),f=l[0],m=l[1],h=Object(a.useState)(c.EMPTY),d=Object(u.a)(h,2),b=d[0],p=d[1],v=function(e){var t=Object(a.useState)(-1),n=Object(u.a)(t,2),c=n[0],s=n[1];Object(a.useEffect)(function(){setTimeout(function(){e?(c>=0&&c<4&&o(),5===c&&o()):c>=0&&c<6&&o()},1500)},[c,e]);var o=function(){return s(function(e){return e+1})};return[c,o,function(){return s(-1)}]}(e.chooseBullet),E=Object(u.a)(v,3),S=E[0],g=E[1],w=E[2];!function(e){var t=Object(a.useRef)(new O.Howl({src:"/audio/spin.mp3"}));Object(a.useEffect)(function(){e&&t.current.play()},[e])}(e.state===y.SPINING);var L=[e.blank,e.blank,e.blank,e.blank,e.blank,e.bullet].map(function(t,n){return s.a.createElement(k,{key:n,src:t,position:n,shot:n===o&&e.state===y.SHOT,load:n<=S,loading:n===S&&e.state===y.LOADING})}),N=function(t,n){g(),setTimeout(function(){t()},n),e.setState(y.LOADING)},I=function(){r(-1),m(0),w(),p(c.EMPTY)},T=function(e){document.documentElement.style.setProperty("--previous","".concat(e))};Object(a.useEffect)(function(){if(e.state===y.LOAD)e.chooseBullet?b===c.EMPTY?N(function(){p(c.HALF),m(5),e.setState(y.IDLE)},7500):b===c.HALF?N(function(){e.setState(y.SPIN),p(c.FULL),T(5)},500):I():(I(),N(function(){m(5),e.setState(y.SPIN),p(c.FULL),T(5)},8300));else if(e.state===y.SPIN&&b===c.FULL){var t=A();setTimeout(function(){m(t),e.setState(y.SHOT)},1700),e.setState(y.SPINING)}else e.state===y.SHOT&&(T(o),e.onShoot(5===o),e.setState(y.IDLE))});var A=function(){var e=Math.floor(6*Math.random());return document.documentElement.style.setProperty("--next","".concat(e)),r(e),e};return s.a.createElement("div",{className:"roulette ".concat(e.state," ").concat(b),style:{transform:"rotate(calc(60deg * ".concat(f,"))")}},L,s.a.createElement("img",{src:j.a,alt:""}))},g=(n(25),function(e){return s.a.createElement("button",{className:"actionButton ".concat(e.visible?"visible":"")},s.a.createElement("img",{src:e.src,alt:""}))}),w=n(12),L=n.n(w),N=n(14),I=n(13),T=n(15),A=function(e){function t(){return Object(i.a)(this,t),Object(N.a)(this,Object(I.a)(t).apply(this,arguments))}return Object(T.a)(t,e),Object(l.a)(t,[{key:"search",value:function(e){var t=this;this.spotify.searchTrack(e).then(function(e){t.setResults(e.tracks.items.slice(0,3))})}},{key:"formatResults",value:function(e){return e.map(function(e){return{title:e.name,author:e.artists[0].name,src:e.album.images[0].url}})}},{key:"getItemSrc",value:function(e){return void 0===e?"":e.album.images[0].url}},{key:"play",value:function(e){this.spotify.play({uris:[e.uri]})}}]),t}(function e(t,n){Object(i.a)(this,e),this.spotify=t,this.setResults=n});!function(e){e.IDLE="idle",e.LOAD="load",e.LOADING="loading",e.SPIN="spin",e.SPINING="spining",e.SHOT="shot"}(y||(y={}));var P=function(){var e=Object(a.useRef)(new h),t=Object(a.useState)(y.IDLE),n=Object(u.a)(t,2),c=n[0],o=n[1],r=Object(a.useState)([]),i=Object(u.a)(r,2),l=i[0],f=i[1],m=Object(a.useState)(),d=Object(u.a)(m,2),b=d[0],p=d[1],O=Object(a.useState)(),E=Object(u.a)(O,2),j=E[0],k=E[1],w=Object(a.useRef)(new A(e.current,f));Object(a.useEffect)(function(){e.current.isAuthenticated()||e.current.authenticateUser()},[]);return s.a.createElement("div",{className:"app"},s.a.createElement("div",{className:"controls"},s.a.createElement(v,{results:w.current.formatResults(l),onSearch:function(e){return w.current.search(e)},onResultClick:function(e){void 0===j?k(l[e]):p(l[e]),f([]),o(y.LOAD)},locked:c!==y.IDLE}),s.a.createElement(g,{src:L.a,visible:c===y.SHOT})),s.a.createElement(S,{blank:w.current.getItemSrc(j),bullet:w.current.getItemSrc(b),state:c,setState:o,chooseBullet:!0,onShoot:function(e){w.current.play(e?b:j)}}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(s.a.createElement(P,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}],[[16,1,2]]]);
//# sourceMappingURL=main.87c393ea.chunk.js.map